/**           __  __
 *    _____ _/ /_/ /_    Computational Intelligence Library (CIlib)
 *   / ___/ / / / __ \   (c) CIRG @ UP
 *  / /__/ / / / /_/ /   http://cilib.net
 *  \___/_/_/_/_.___/
 */
package net.sourceforge.cilib.math;

import java.util.Arrays;
import static org.junit.Assert.*;
import org.junit.Test;

public class StatsTablesTest {

    private static double[][] chiSqr = new double[][]{
        {3.84, 6.64, 10.83},
        {5.99, 9.21, 13.82},
        {7.82, 11.35, 16.27},
        {9.49, 13.28, 18.47},
        {11.07, 15.09, 20.52},
        {12.59, 16.81, 22.46},
        {14.07, 18.48, 24.32},
        {15.51, 20.09, 26.13},
        {16.92, 21.67, 27.88},
        {18.31, 23.21, 29.59},
        {19.68, 24.73, 31.26},
        {21.03, 26.22, 32.91},
        {22.36, 27.69, 34.53},
        {23.69, 29.14, 36.12},
        {25.00, 30.58, 37.70},
        {26.30, 32.00, 39.25},
        {27.59, 33.41, 40.79},
        {28.87, 34.81, 42.31},
        {30.14, 36.19, 43.82},
        {31.41, 37.57, 45.32},
        {32.67, 38.93, 46.80},
        {33.92, 40.29, 48.27},
        {35.17, 41.64, 49.73},
        {36.42, 42.98, 51.18},
        {37.65, 44.31, 52.62},
        {38.89, 45.64, 54.05},
        {40.11, 46.96, 55.48},
        {41.34, 48.28, 56.89},
        {42.56, 49.59, 58.30},
        {43.77, 50.89, 59.70}
    };
    private static double[][] t = new double[][]{
        {12.70, 63.65, 636.62},
        {4.30, 9.92, 31.59},
        {3.18, 5.84, 12.92},
        {2.77, 4.60, 8.58},
        {2.57, 4.03, 6.86},
        {2.44, 3.70, 5.95},
        {2.36, 3.49, 5.40},
        {2.30, 3.35, 5.04},
        {2.26, 3.24, 4.78},
        {2.22, 3.16, 4.58},
        {2.20, 3.10, 4.43},
        {2.17, 3.05, 4.31},
        {2.16, 3.01, 4.22},
        {2.14, 2.97, 4.14},
        {2.13, 2.94, 4.07},
        {2.11, 2.92, 4.01},
        {2.10, 2.89, 3.96},
        {2.10, 2.87, 3.92},
        {2.09, 2.86, 3.88},
        {2.08, 2.84, 3.84},
        {2.07, 2.83, 3.81},
        {2.07, 2.81, 3.79},
        {2.06, 2.80, 3.76},
        {2.06, 2.79, 3.74},
        {2.05, 2.78, 3.72},
        {2.05, 2.77, 3.70},
        {2.05, 2.77, 3.68},
        {2.04, 2.76, 3.67},
        {2.04, 2.75, 3.65},
        {2.04, 2.75, 3.64}
    };
    
    @Test
    public void testChiSquaredDistribution() {
        Double[] p = new Double[]{0.05, 0.01, 0.001};
        for (double d : p) {
            for (int i = 0; i < 30; i++) {
                assertEquals(chiSqr[i][Arrays.asList(p).indexOf(d)], StatsTables.chisqrDistribution(i + 1, d), 0.01);
            }
        }
    }
    
    @Test
    public void testTDistribution() {
        Double[] p = new Double[]{0.025, 0.005, 0.0005};
        for (double d : p) {
            for (int i = 0; i < 30; i++) {
                assertEquals(t[i][Arrays.asList(p).indexOf(d)], StatsTables.tDistribution(i + 1, d), 0.01);
            }
        }
    }
}
